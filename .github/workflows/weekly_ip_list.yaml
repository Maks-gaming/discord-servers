name: ğŸ” Update Voice IP lists

on:
  schedule:
    - cron: "0 0 * * 0"
  workflow_dispatch:

jobs:
  update_voice_lists:
    runs-on: ubuntu-latest

    steps:
      - name: â˜‘ï¸ Checkout
        uses: actions/checkout@v2

      - name: ğŸ Set up Python3
        uses: actions/setup-python@v2
        with:
          python-version: "3.x"

      - name: â†˜ï¸ Install dependencies
        run: |
          python -m pip install --upgrade pip
          pip install dnspython
          pip install aiofiles

      - name: ğŸŒ Resolve atlanta
        run: |
          python ./src/generate_voice_ip_list.py atlanta

      - name: ğŸŒ Resolve brazil
        run: |
          python ./src/generate_voice_ip_list.py brazil

      - name: ğŸŒ Resolve bucharest
        run: |
          python ./src/generate_voice_ip_list.py bucharest

      - name: ğŸŒ Resolve buenos-aires
        run: |
          python ./src/generate_voice_ip_list.py bucharest

      - name: ğŸŒ Resolve dubai
        run: |
          python ./src/generate_voice_ip_list.py dubai

      - name: ğŸŒ Resolve finland
        run: |
          python ./src/generate_voice_ip_list.py finland

      - name: ğŸŒ Resolve frankfurt
        run: |
          python ./src/generate_voice_ip_list.py frankfurt

      - name: ğŸŒ Resolve hongkong
        run: |
          python ./src/generate_voice_ip_list.py hongkong

      - name: ğŸŒ Resolve india
        run: |
          python ./src/generate_voice_ip_list.py india

      - name: ğŸŒ Resolve japan
        run: |
          python ./src/generate_voice_ip_list.py japan

      - name: ğŸŒ Resolve madrid
        run: |
          python ./src/generate_voice_ip_list.py madrid

      - name: ğŸŒ Resolve milan
        run: |
          python ./src/generate_voice_ip_list.py milan

      - name: ğŸŒ Resolve newark
        run: |
          python ./src/generate_voice_ip_list.py newark

      - name: ğŸŒ Resolve rotterdam
        run: |
          python ./src/generate_voice_ip_list.py rotterdam

      - name: ğŸŒ Resolve russia
        run: |
          python ./src/generate_voice_ip_list.py russia

      - name: ğŸŒ Resolve santa-clara
        run: |
          python ./src/generate_voice_ip_list.py santa-clara

      - name: ğŸŒ Resolve santiago
        run: |
          python ./src/generate_voice_ip_list.py santiago

      - name: ğŸŒ Resolve seattle
        run: |
          python ./src/generate_voice_ip_list.py seattle

      - name: ğŸŒ Resolve singapore
        run: |
          python ./src/generate_voice_ip_list.py singapore

      - name: ğŸŒ Resolve south-korea
        run: |
          python ./src/generate_voice_ip_list.py south-korea

      - name: ğŸŒ Resolve southafrica
        run: |
          python ./src/generate_voice_ip_list.py southafrica

      - name: ğŸŒ Resolve stage-scale
        run: |
          python ./src/generate_voice_ip_list.py stage-scale

      - name: ğŸŒ Resolve stockholm
        run: |
          python ./src/generate_voice_ip_list.py stockholm

      - name: ğŸŒ Resolve sydney
        run: |
          python ./src/generate_voice_ip_list.py sydney

      - name: ğŸŒ Resolve tel-aviv
        run: |
          python ./src/generate_voice_ip_list.py tel-aviv

      - name: ğŸŒ Resolve us-central
        run: |
          python ./src/generate_voice_ip_list.py us-central

      - name: ğŸŒ Resolve us-east
        run: |
          python ./src/generate_voice_ip_list.py us-east

      - name: ğŸŒ Resolve us-south
        run: |
          python ./src/generate_voice_ip_list.py us-south

      - name: ğŸŒ Resolve us-west
        run: |
          python ./src/generate_voice_ip_list.py us-west

      - name: ğŸŒ Resolve warsaw
        run: |
          python ./src/generate_voice_ip_list.py warsaw

      - name: ğŸŒ Resolve st-pete
        run: |
          python ./src/generate_voice_ip_list.py st-pete

      - name: ğŸŒ Resolve dammam
        run: |
          python ./src/generate_voice_ip_list.py dammam

      - name: ğŸŒ Resolve jakarta
        run: |
          python ./src/generate_voice_ip_list.py jakarta

      - name: ğŸŒ Resolve montreal
        run: |
          python ./src/generate_voice_ip_list.py montreal

      - name: ğŸŒ Resolve oregon
        run: |
          python ./src/generate_voice_ip_list.py oregon

      - name: â†—ï¸ Update ip_list.txt
        run: |
          cp ./ip_list_new.txt ./ip_list.txt
          rm ./ip_list_new.txt

      - name: ğŸ’« Commit the changes
        run: |
          git config --global user.name "github-actions"
          git config --global user.email "github-actions@github.com"
          git add ./ip_list.txt
          git commit -m "Update IP list"
          git push https://x-access-token:${{ secrets.GITHUB_TOKEN }}@github.com/${{ github.repository }}.git HEAD:main
